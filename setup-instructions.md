# 📊 Google Apps Script セットアップ手順

## 1. Google スプレッドシート作成

1. [Google スプレッドシート](https://sheets.google.com)にアクセス
2. 新しいスプレッドシートを作成
3. ファイル名を「プレイフル診断データ」に変更
4. URLからスプレッドシートIDをコピー
   - URL例: `https://docs.google.com/spreadsheets/d/1ABC...XYZ/edit`
   - IDは `1ABC...XYZ` の部分

## 2. Google Apps Script プロジェクト作成

1. [Google Apps Script](https://script.google.com)にアクセス
2. 「新しいプロジェクト」をクリック
3. プロジェクト名を「プレイフル診断API」に変更

## 3. コード設定

1. `google-apps-script.js` のコード全体をコピー
2. Apps Script エディタの `Code.gs` にペースト
3. 2行目の `SPREADSHEET_ID` を実際のIDに変更：
   ```javascript
   const SPREADSHEET_ID = '実際のスプレッドシートID';
   ```

## 4. 権限設定

1. 「承認が必要」と表示された場合は「権限を確認」をクリック
2. Googleアカウントでログイン
3. 「詳細」→「プレイフル診断API（安全ではないページ）に移動」
4. 「許可」をクリック

## 5. デプロイ

1. 「デプロイ」→「新しいデプロイ」をクリック
2. 種類で「ウェブアプリ」を選択
3. 設定：
   - **説明**: プレイフル診断データ収集API
   - **次のユーザーとして実行**: 自分
   - **アクセスできるユーザー**: 全員
4. 「デプロイ」をクリック
5. **ウェブアプリのURL**をコピー（重要！）

## 6. アプリ側の設定

1. `index.html` の701行目を編集：
   ```javascript
   const GOOGLE_SCRIPT_URL = 'コピーしたウェブアプリのURL';
   ```

## 7. テスト

1. アプリで診断を完了
2. スプレッドシートにデータが追加されることを確認

## 📋 スプレッドシートの列構成

| 列 | 項目 | 説明 |
|---|---|---|
| A | 診断日時 | 回答完了日時 |
| B | 名前 | 回答者名 |
| C | 年齢 | 回答者年齢 |
| D | 性別 | 回答者性別 |
| E | メールアドレス | 連絡先 |
| F | 総合スコア | 全体平均スコア |
| G | 日常の楽しさ発見 | 因子1スコア |
| H | 自由感・解放感 | 因子2スコア |
| I | 創造的・自発的活動 | 因子3スコア |
| J | 子どもとのプレイフル交流 | 因子4スコア |
| K | 社会的つながりでの楽しさ | 因子5スコア |
| L | ユーザーエージェント | ブラウザ情報 |
| M-AK | Q1-Q25 | 各質問の回答 |

## 🔧 トラブルシューティング

### エラー: 権限がありません
- スプレッドシートIDが正しいか確認
- スプレッドシートの共有設定を確認

### エラー: CORS
- デプロイ設定で「全員」に設定されているか確認
- 新しいバージョンでデプロイし直す

### データが保存されない
- ブラウザの開発者ツールでネットワークエラーを確認
- Apps Script の実行トランスクリプトを確認

## 📊 データ分析

Google スプレッドシートの機能を使用して：
- ピボットテーブルでの集計
- グラフでの可視化
- 統計分析

## 🔒 セキュリティ

- 個人情報は適切に管理
- スプレッドシートのアクセス権限を制限
- 定期的なデータバックアップを推奨